<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Python 에서 Tajo 사용하기 | Healthcare data note by wonjun</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Python 에서 Tajo 사용하기" />
<meta name="author" content="Hong Wonjun" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="라인웍스에서는 정적인 데이터를 분석하는 경우 데이터레이크(Data Lake) 로 TAJO 를 사용하고 있다. 회사 내에서 분석하고 서비스로 만들어내는 모든 데이터는 여기에서 시작된다. 우선 TAJO 에 Query 를 이용하여 데이터를 쪼개보고, 붙여보고, 나열해본 후에는 이를 csv 파일로 만든 후 에 Python 으로 load 하여 그래프를 그리거나 머신러닝 알고리즘을 수행하는 형식이다. (Python 의 경우 직접 실행하는 방법도 있고 IPython Notebook 을 사용하기도 한다.)" />
<meta property="og:description" content="라인웍스에서는 정적인 데이터를 분석하는 경우 데이터레이크(Data Lake) 로 TAJO 를 사용하고 있다. 회사 내에서 분석하고 서비스로 만들어내는 모든 데이터는 여기에서 시작된다. 우선 TAJO 에 Query 를 이용하여 데이터를 쪼개보고, 붙여보고, 나열해본 후에는 이를 csv 파일로 만든 후 에 Python 으로 load 하여 그래프를 그리거나 머신러닝 알고리즘을 수행하는 형식이다. (Python 의 경우 직접 실행하는 방법도 있고 IPython Notebook 을 사용하기도 한다.)" />
<link rel="canonical" href="https//hongwonjun.github.io/python/2016/01/27/Python-%EC%97%90%EC%84%9C-Tajo-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0.html" />
<meta property="og:url" content="https//hongwonjun.github.io/python/2016/01/27/Python-%EC%97%90%EC%84%9C-Tajo-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0.html" />
<meta property="og:site_name" content="Healthcare data note by wonjun" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-01-27T00:00:00+09:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https//hongwonjun.github.io/python/2016/01/27/Python-%EC%97%90%EC%84%9C-Tajo-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0.html"},"url":"https//hongwonjun.github.io/python/2016/01/27/Python-%EC%97%90%EC%84%9C-Tajo-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0.html","author":{"@type":"Person","name":"Hong Wonjun"},"headline":"Python 에서 Tajo 사용하기","dateModified":"2016-01-27T00:00:00+09:00","datePublished":"2016-01-27T00:00:00+09:00","description":"라인웍스에서는 정적인 데이터를 분석하는 경우 데이터레이크(Data Lake) 로 TAJO 를 사용하고 있다. 회사 내에서 분석하고 서비스로 만들어내는 모든 데이터는 여기에서 시작된다. 우선 TAJO 에 Query 를 이용하여 데이터를 쪼개보고, 붙여보고, 나열해본 후에는 이를 csv 파일로 만든 후 에 Python 으로 load 하여 그래프를 그리거나 머신러닝 알고리즘을 수행하는 형식이다. (Python 의 경우 직접 실행하는 방법도 있고 IPython Notebook 을 사용하기도 한다.)","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https//hongwonjun.github.io/feed.xml" title="Healthcare data note by wonjun" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Healthcare data note by wonjun</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Python 에서 Tajo 사용하기</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-01-27T00:00:00+09:00" itemprop="datePublished">Jan 27, 2016
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Hong Wonjun</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>라인웍스에서는 정적인 데이터를 분석하는 경우 데이터레이크(Data Lake) 로 <a href="http://tajo.apache.org/">TAJO</a> 를 사용하고 있다. 회사 내에서 분석하고 서비스로 만들어내는 모든 데이터는 여기에서 시작된다. 우선 TAJO 에 Query 를 이용하여 데이터를 쪼개보고, 붙여보고, 나열해본 후에는 이를 csv 파일로 만든 후 에 <a href="https://www.python.org/">Python</a> 으로 load 하여 그래프를 그리거나 머신러닝 알고리즘을 수행하는 형식이다.<br />
<em>(Python 의 경우 직접 실행하는 방법도 있고 <a href="http://ipython.org/notebook.html">IPython Notebook</a> 을 사용하기도 한다.)</em></p>

<p>결국 Data - TAJO - CSV - Python - RESULTS 와 같은 단계를 거치게 되는데 이 단계를 단축시켜보자는게 이 포스팅의 목적이다.</p>

<h2 id="tajo-에-대해서-간단히-알아보자">TAJO 에 대해서 간단히 알아보자.</h2>

<hr />

<blockquote>
  <p>Apache Tajo is a robust big data relational and distributed data warehouse system for Apache Hadoop. Tajo is designed for low-latency and scalable ad-hoc queries, online aggregation, and ETL (extract-transform-load process) on large-data sets stored on HDFS (Hadoop Distributed File System) and other data sources. By supporting SQL standards and leveraging advanced database techniques, Tajo allows direct control of distributed execution and data flow across a variety of query evaluation strategies and optimization opportunities. (<a href="http://tajo.apache.org/">TAJO 공식 홈페이지</a>)</p>
</blockquote>

<p>TAJO 공식 홈페이지에서 가져온 소개글인데, 간단히 정리하면 Hadoop 기반의 Data warehouse 로 SQL 질의(query) 를 통하여 데이터를 다룰 수 있는 시스템이다.</p>

<h2 id="python-에서-tajo-를-사용해보자">Python 에서 TAJO 를 사용해보자</h2>

<hr />

<p>간단하게 이야기해서 Python 에서 TAJO 를 호출하여 사용할 수 있도록 하면된다.</p>

<p>우선 TAJO 가 JDBC 를 지원하기 때문에 <a href="http://tajo.apache.org/docs/current/jdbc_driver.html">Tajo JDBC Driver</a> 를 이용하도록 한다.</p>

<p>Python 에서 JDBC 를 사용하기 위해서 <a href="https://pypi.python.org/pypi/JayDeBeApi/">JayDeBeApi</a> 을 설치한다.</p>

<p>설치는 pip 를 이용해서 할 수 있다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>pip <span class="nb">install </span>JayDeBeApi</code></pre></figure>

<p>JayDeBeApi 기본 Tutorial 과 다른 부분이 있는데 JPype 를 이용해서 JVM 을 올려줘야 한다. (jar 파일의 위치는 tajo 가 설치된 위치를 이용하여 바꿔주자.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">jaydebeapi</span><span class="p">,</span> <span class="n">jpype</span>
<span class="n">jar</span> <span class="o">=</span> <span class="s">'${TAJO_HOME}/share/jdbc-dist/tajo-jdbc-x.y.z.jar'</span>
<span class="n">args</span> <span class="o">=</span> <span class="s">'-Djava.class.path=</span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">jar</span>
<span class="n">jvm_path</span> <span class="o">=</span> <span class="n">jpype</span><span class="o">.</span><span class="n">getDefaultJVMPath</span><span class="p">()</span>
<span class="n">jpype</span><span class="o">.</span><span class="n">startJVM</span><span class="p">(</span><span class="n">jvm_path</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></code></pre></figure>

<p>이제 tajo 에 connect 요청을 할 수 있다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">conn</span> <span class="o">=</span> <span class="n">jaydebeapi</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">"org.apache.tajo.jdbc.TajoDriver"</span><span class="p">,</span><span class="s">"jdbc:tajo://host:port/database"</span><span class="p">)</span>
<span class="n">curs</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span></code></pre></figure>

<p>아래와 같이 query 를 실행할 수 있다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">query</span> <span class="o">=</span> <span class="s">"select * from table1"</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span></code></pre></figure>

<hr />

<ul>
  <li>이 글은 현재 일하고 있는 <a href="http://linewalks.com/blog">라인웍스의  블로그</a> 에 기고한 글로 원문의 주소는 아래와 같다.</li>
  <li>http://linewalks.com/archives/1085</li>
</ul>


  </div><a class="u-url" href="/python/2016/01/27/Python-%EC%97%90%EC%84%9C-Tajo-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Healthcare data note by wonjun</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Healthcare data note by wonjun</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/hongwonjun"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">hongwonjun</span></a></li><li><a href="https://www.twitter.com/hongwonjun"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">hongwonjun</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>스타트업에서 헬스케어 데이터를 다루는 데이터쟁이의 노트.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
